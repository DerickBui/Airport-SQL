--all airlines
SELECT a.AIRPORTNAME, f.AIRLINENAME FROM airport a NATURAL JOIN schedule s NATURAL JOIN flight f
GROUP BY a.AIRPORTNAME, f.AIRLINENAME
ORDER BY a.AIRPORTNAME;

--all departing airports per airline
SELECT f.airlineName, s.departingAirport FROM schedule s INNER JOIN flight f
ON s.SID = f.SID
ORDER BY f.airlineName;

--all arriving airports
SELECT f.airlineName, s.arrivingAirport FROM schedule s INNER JOIN flight f
ON s.SID = f.SID
ORDER BY f.airlineName;

--shortest flight
select f.AIRLINENAME, MIN({fn timestampdiff(SQL_TSI_SECOND, f.ADEPTIME, f.AARRTIME)}) AS "Actual Seconds Difference" FROM flight f
GROUP BY f.AIRLINENAME
ORDER BY f.AIRLINENAME;

--longest flight
select f.AIRLINENAME, MAX({fn timestampdiff(SQL_TSI_SECOND, f.ADEPTIME, f.AARRTIME)}) AS "Actual Seconds Difference" FROM flight f
GROUP BY f.AIRLINENAME
ORDER BY f.AIRLINENAME;

--flights with extras
SELECT s.FLIGHTNUM, s.DEPARTINGAIRPORT, s.ARRIVINGAIRPORT, s.DEPARTURETIME, s.ARRIVALTIME, a."TYPE", a.COST
FROM schedule s 
INNER JOIN chargedFlight chg ON s.SID = chg.SID
INNER JOIN amenity a ON chg.SID = a.SID;

--crew roster
SELECT fl.AIRLINENAME, c.CREWNAME, cm.FNAME, cm.LNAME, cm.FAANUM FROM flight fl
INNER JOIN crew c ON fl.CID = c.CID
INNER JOIN crewmember cm ON c.CID = cm.CID
ORDER BY fl.FAATAILNUM, c.CREWNAME, cm.FNAME ASC;

--available trips
SELECT s.DEPARTINGAIRPORT, s.ARRIVINGAIRPORT FROM schedule s
ORDER BY s.DEPARTINGAIRPORT;

--count of arriving airport in city
SELECT a.LOCATION, s.ARRIVINGAIRPORT AS "Arriving Airports" FROM airport a 
LEFT OUTER JOIN schedule s ON a.AIRPORTNAME = s.ARRIVINGAIRPORT
WHERE s.ARRIVINGAIRPORT IS NOT NULL
ORDER BY a.LOCATION;

--count of departing airport in city
SELECT a.LOCATION, s.DEPARTINGAIRPORT AS "Departing Airports" FROM airport a 
LEFT OUTER JOIN schedule s ON a.AIRPORTNAME = s.DEPARTINGAIRPORT
WHERE s.DEPARTINGAIRPORT IS NOT NULL
ORDER BY a.LOCATION;

--airlines in service category
SELECT a."TYPE", f.AIRLINENAME FROM amenity a NATURAL JOIN chargedFlight chg
NATURAL JOIN schedule s NATURAL JOIN flight f
ORDER BY a."TYPE";

--crew having more than one flight a day
SELECT c.CREWNAME FROM crew c
INNER JOIN flight f ON c.CID = f.CID
GROUP BY c.CREWNAME
HAVING COUNT(f.dates) > 1;

--all incident reports
SELECT * FROM incidentReport
ORDER BY FID;

--within 3 days
select f.FAATAILNUM, f.DATES, {fn timestampdiff(SQL_TSI_DAY, current_date, f.DATES)} AS "Actual Day Difference" 
FROM flight f
WHERE {fn timestampdiff(SQL_TSI_DAY, current_date, f.DATES)} <= 3
AND {fn timestampdiff(SQL_TSI_DAY, current_date, f.DATES)} >= 0;

--in a week of busiest airport
SELECT a.LOCATION, COUNT(s.ARRIVINGAIRPORT) AS "Number of Flights"
FROM airport a
INNER JOIN schedule s ON a.AIRPORTNAME = s.ARRIVINGAIRPORT
INNER JOIN flight f ON s.SID = f.SID
WHERE {fn timestampdiff(SQL_TSI_DAY, current_date, f.DATES)} < 7
AND {fn timestampdiff(SQL_TSI_DAY, current_date, f.DATES)} > -7
GROUP BY a.LOCATION;

--30 min late
SELECT f.FAATAILNUM,{fn timestampdiff(SQL_TSI_MINUTE, f.ADEPTIME, s.DEPARTURETIME)} AS "Actual Minute Difference"
FROM flight f NATURAL JOIN schedule s
WHERE {fn timestampdiff(SQL_TSI_MINUTE, f.ADEPTIME, s.DEPARTURETIME)} > 30;

--individually assigned 1, all the planes the company owns
SELECT p.AIRLINENAME, p.PLANENAME, p.FAATAILNUM, p.YEARSOFSERV FROM plane p
ORDER BY p.AIRLINENAME, p.YEARSOFSERV;

--individually assigned 2, all the flights per plane
SELECT p.AIRLINENAME, p.PLANENAME, f.DATES, f.ADEPTIME, f.AARRTIME FROM flight f NATURAL JOIN plane p
ORDER BY p.AIRLINENAME, p.PLANENAME;